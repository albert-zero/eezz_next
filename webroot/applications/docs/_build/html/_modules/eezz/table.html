

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>eezz.table &mdash; EEZZ 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            EEZZ
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">eezz</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">EEZZ</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">eezz.table</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for eezz.table</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/python3</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This module implements the following classes:</span>

<span class="sd">    * :py:class:`eezz.table.TTableCell`:   Defines properties of a table cell</span>
<span class="sd">    * :py:class:`eezz.table.TTableRow`:    Defines properties of a table row, containing a list of TTableCells</span>
<span class="sd">    * :py:class:`eezz.table.TTableColumn`: Defines properties of a table column</span>
<span class="sd">    * :py:class:`eezz.table.TTable`:       Defines properties of a table, containing a list of TTableRows</span>
<span class="sd">    * :py:class:`eezz.table.TTableException`: Exception on checking the row-id, which has to be unique</span>

<span class="sd">    TTable is used for formatted ASCII output of a table structure.</span>
<span class="sd">    It allows to access the table data for further processing e.g. for HTML output. The class handles an</span>
<span class="sd">    internal read cursor, which allows to navigate in the list of rows and to read a fixed amount of rows.</span>

<span class="sd">    TTable is a list of TTableRow objects, each of which is a list of TCell objects.</span>
<span class="sd">    The TTableColumn holds the as well column names as types and is used to organize sort and filter.</span>
<span class="sd">    A TTableCell object could hold a TTable object for recursive tree structures.</span>

<span class="sd">    Besides this the following enumerations are used</span>

<span class="sd">    * :py:class:`eezz.table.TNavigation`:   Enumeration for method :py:meth:`eezz.table.TTable.navigate`</span>
<span class="sd">    * :py:class:`eezz.table.TSort`:         Enumeration for method :py:meth:`eezz.table.TTable.do_sort`</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span>  <span class="nn">itertools</span>
<span class="kn">import</span>  <span class="nn">os</span>
<span class="kn">import</span>  <span class="nn">re</span>
<span class="kn">from</span>    <span class="nn">collections.abc</span>  <span class="kn">import</span> <span class="n">Callable</span>
<span class="kn">from</span>    <span class="nn">collections</span> <span class="kn">import</span> <span class="n">UserList</span>
<span class="kn">from</span>    <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">from</span>    <span class="nn">itertools</span>   <span class="kn">import</span> <span class="n">filterfalse</span><span class="p">,</span> <span class="n">chain</span>
<span class="kn">from</span>    <span class="nn">typing</span>      <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">NewType</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">ClassVar</span>
<span class="kn">from</span>    <span class="nn">enum</span>        <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span>    <span class="nn">pathlib</span>     <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span>    <span class="nn">datetime</span>    <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timezone</span>
<span class="kn">from</span>    <span class="nn">copy</span>        <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">from</span>    <span class="nn">abc</span>         <span class="kn">import</span> <span class="n">abstractmethod</span>
<span class="kn">from</span>    <span class="nn">Crypto.Hash</span> <span class="kn">import</span> <span class="n">SHA1</span>

<span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">override</span>

<span class="kn">from</span>    <span class="nn">service</span>     <span class="kn">import</span> <span class="n">TService</span>
<span class="kn">from</span>    <span class="nn">threading</span>   <span class="kn">import</span> <span class="n">Condition</span><span class="p">,</span> <span class="n">Lock</span>
<span class="kn">import</span>  <span class="nn">logging</span>
<span class="kn">import</span>  <span class="nn">logging.config</span>
<span class="kn">import</span>  <span class="nn">sqlite3</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">)</span>
<span class="n">logging_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;disable_existing_loggers&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;formatters&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;simple&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%(levelname)s</span><span class="s1">: </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;handlers&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;stdout&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;logging.StreamHandler&#39;</span><span class="p">,</span>
            <span class="s1">&#39;formatter&#39;</span><span class="p">:</span> <span class="s1">&#39;simple&#39;</span><span class="p">,</span>
            <span class="s1">&#39;stream&#39;</span><span class="p">:</span> <span class="s1">&#39;ext://sys.stdout&#39;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;loggers&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;root&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="s1">&#39;DEBUG&#39;</span><span class="p">,</span> <span class="s1">&#39;handlers&#39;</span><span class="p">:[</span><span class="s1">&#39;stdout&#39;</span><span class="p">]}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">TTableException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; The table exception: trying to insert a double row-id &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>


<div class="viewcode-block" id="TNavigation">
<a class="viewcode-back" href="../../eezz.html#eezz.table.TNavigation">[docs]</a>
<span class="k">class</span> <span class="nc">TNavigation</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Elements to describe navigation events for method :py:func:`eezz.table.TTable.navigate`. The navigation is</span>
<span class="sd">    organized in chunks of rows given by property</span>
<span class="sd">    :ref:`TTable.visible_items &lt;ttable_parameter_list&gt;`:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ABS</span>     <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Request an absolute position in the dataset&#39;</span>
    <span class="n">NEXT</span>    <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Set the cursor to show the next chunk of rows&#39;</span>
    <span class="n">PREV</span>    <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Set the cursor to show the previous chunk of rows&#39;</span>
    <span class="n">TOP</span>     <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Set the cursor to the first row&#39;</span>
    <span class="n">LAST</span>    <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;Set the cursor to show the last chunk of rows&#39;</span></div>



<div class="viewcode-block" id="TSort">
<a class="viewcode-back" href="../../eezz.html#eezz.table.TSort">[docs]</a>
<span class="k">class</span> <span class="nc">TSort</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Sorting control enum to define sort on columns &quot;&quot;&quot;</span>
    <span class="n">NONE</span>    <span class="o">=</span> <span class="mi">0</span>
    <span class="n">ASC</span>     <span class="o">=</span> <span class="mi">1</span>
    <span class="n">DESC</span>    <span class="o">=</span> <span class="mi">2</span></div>



<div class="viewcode-block" id="TTableCell">
<a class="viewcode-back" href="../../eezz.html#eezz.table.TTableCell">[docs]</a>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">TTableCell</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; The cell is the smallest unit of a table. This class is a dataclass, so all</span>
<span class="sd">    parameters become properties</span>

<span class="sd">    :param name:  Name of the corresponding column</span>
<span class="sd">    :type  name:  str</span>
<span class="sd">    :param value: Content of the cell</span>
<span class="sd">    :type  type:  str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span><span class="p">:</span>       <span class="nb">str</span>                 <span class="c1">#: :meta private: Name of the column</span>
    <span class="n">value</span><span class="p">:</span>      <span class="n">Any</span>                 <span class="c1">#: :meta private: Value of the cell</span>
    <span class="n">width</span><span class="p">:</span>      <span class="nb">int</span>     <span class="o">=</span> <span class="mi">10</span>        <span class="c1">#: :meta private: calculated width of a cell</span>
    <span class="n">index</span><span class="p">:</span>      <span class="nb">int</span>     <span class="o">=</span> <span class="mi">0</span>         <span class="c1">#: :meta private: calculated index of a cell</span>
    <span class="nb">type</span><span class="p">:</span>       <span class="nb">str</span>     <span class="o">=</span> <span class="s1">&#39;str&#39;</span>     <span class="c1">#: :meta private: calculated type (could also be user defined)</span>
    <span class="n">attrs</span><span class="p">:</span>      <span class="nb">dict</span>    <span class="o">=</span> <span class="kc">None</span>      <span class="c1">#: :meta private: user attributes</span></div>



<div class="viewcode-block" id="TTableColumn">
<a class="viewcode-back" href="../../eezz.html#eezz.table.TTableColumn">[docs]</a>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">TTableColumn</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Summarize the cell properties in a column, which includes sorting and formatting.</span>
<span class="sd">    This class is a dataclass, so all parameters become properties.</span>

<span class="sd">    :param header:  Display name for the column</span>
<span class="sd">    :type  header:  str</span>
<span class="sd">    :param attrs:   User attributes</span>
<span class="sd">    :type  attrs:   dict</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">header</span><span class="p">:</span>     <span class="nb">str</span>                 <span class="c1">#: :meta private: Name of the column</span>
    <span class="n">attrs</span><span class="p">:</span>      <span class="nb">dict</span>    <span class="o">=</span> <span class="kc">None</span>      <span class="c1">#: :meta private: Customizable attributes of the column</span>
    <span class="n">index</span><span class="p">:</span>      <span class="nb">int</span>     <span class="o">=</span> <span class="mi">0</span>         <span class="c1">#: :meta private: Calculated index of the column</span>
    <span class="n">width</span><span class="p">:</span>      <span class="nb">int</span>     <span class="o">=</span> <span class="mi">10</span>        <span class="c1">#: :meta private: Calculated width of the column</span>
    <span class="n">alias</span><span class="p">:</span>      <span class="nb">str</span>     <span class="o">=</span> <span class="s1">&#39;&#39;</span>        <span class="c1">#: :meta private: Alias name for output</span>
    <span class="n">sort</span><span class="p">:</span>       <span class="nb">bool</span>    <span class="o">=</span> <span class="kc">True</span>      <span class="c1">#: :meta private: Sort direction of the column</span>
    <span class="nb">type</span><span class="p">:</span>       <span class="nb">str</span>     <span class="o">=</span> <span class="s1">&#39;str&#39;</span>     <span class="c1">#: :meta private: Type of the column</span>
    <span class="nb">filter</span><span class="p">:</span>     <span class="nb">str</span>     <span class="o">=</span> <span class="kc">None</span>      <span class="c1">#: :meta private: Filter string</span></div>



<span class="c1"># forward declaration</span>
<span class="n">TTable</span> <span class="o">=</span> <span class="n">NewType</span><span class="p">(</span><span class="s1">&#39;TTable&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>


<div class="viewcode-block" id="TTableRow">
<a class="viewcode-back" href="../../eezz.html#eezz.table.TTableRow">[docs]</a>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">TTableRow</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This structure is created for each row in a table.</span>

<span class="sd">    :param cells:   List of row values. If specified as list of string values of the</span>
<span class="sd">                    column descriptor are calculated to default.</span>
<span class="sd">                    If specified as list of TTableCell you could set specific values during creation</span>
<span class="sd">    :type  cells:   List[TTableCell | str]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cells</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">TTableCell</span><span class="p">]</span> <span class="o">|</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>  <span class="c1">#: Property - A list of strings are converted to a list of TTableCells</span>
    <span class="n">cells_filter</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">TTableCell</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: :meta private: Filtered cells used for re-ordering and alias names.</span>
    <span class="n">column_descr</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>      <span class="c1">#: :meta private: The column descriptor holds the attributes of the columns</span>
    <span class="n">index</span><span class="p">:</span>      <span class="nb">int</span>         <span class="o">=</span> <span class="kc">None</span>      <span class="c1">#: :meta private: Unique address for the columns</span>
    <span class="n">row_id</span><span class="p">:</span>     <span class="nb">str</span>         <span class="o">=</span> <span class="kc">None</span>      <span class="c1">#: :meta private: Unique row id of the row, valid for the entire table</span>
    <span class="n">child</span><span class="p">:</span>      <span class="n">TTable</span>      <span class="o">=</span> <span class="kc">None</span>      <span class="c1">#: :meta private: A row could handle recursive data structures</span>
    <span class="nb">type</span><span class="p">:</span>       <span class="nb">str</span>         <span class="o">=</span> <span class="s1">&#39;body&#39;</span>    <span class="c1">#: :meta private: Customizable type used for triggering template output</span>
    <span class="n">attrs</span><span class="p">:</span>      <span class="nb">dict</span>        <span class="o">=</span> <span class="kc">None</span>      <span class="c1">#: :meta private: Customizable row attributes</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Create a row, converting the values to :py:obj:`eezz.table.TTableCell` &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">)</span> <span class="ow">is</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cells</span> <span class="o">=</span> <span class="p">[</span><span class="n">TTableCell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">value</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">column_descr</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<div class="viewcode-block" id="TTableRow.get_values_list">
<a class="viewcode-back" href="../../eezz.html#eezz.table.TTableRow.get_values_list">[docs]</a>
    <span class="k">def</span> <span class="nf">get_values_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get all values in a row as a list &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">]</span></div>


    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Allows field access: value = row[column] &quot;&quot;&quot;</span>
        <span class="n">x_inx</span> <span class="o">=</span> <span class="n">column</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_descr</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">x_inx</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Allows field access: r[column] = value &quot;&quot;&quot;</span>
        <span class="n">x_inx</span> <span class="o">=</span> <span class="n">column</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_descr</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">x_inx</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span></div>



<div class="viewcode-block" id="TTable">
<a class="viewcode-back" href="../../eezz.html#eezz.table.TTable">[docs]</a>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">TTable</span><span class="p">(</span><span class="n">UserList</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; The table is derived from User-list to enable sort and list management</span>
<span class="sd">    This is a dataclass, so the arguments become properties</span>

<span class="sd">    .. _ttable_parameter_list:</span>

<span class="sd">    :param column_names:    List of names for each column</span>
<span class="sd">    :type  column_names:    List[str]</span>
<span class="sd">    :param title:           Table name and title</span>
<span class="sd">    :type  title:           str</span>

<span class="sd">    :ivar Dict[str, Callable[size, value]] format_types: A map for types and format rules.</span>
<span class="sd">        The callable takes two variables, the width and the value.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Table instance:</span>

<span class="sd">        &gt;&gt;&gt; from table import TTable</span>
<span class="sd">        &gt;&gt;&gt; my_table = TTable(column_names=[&#39;FileName&#39;, &#39;Size&#39;], title=&#39;Directory&#39;)</span>
<span class="sd">        &gt;&gt;&gt; # for file in Path(&#39;.&#39;).iterdir():</span>
<span class="sd">        &gt;&gt;&gt; #    my_table.append(table_row=[file, file.stat().st_size])</span>
<span class="sd">        &gt;&gt;&gt; row = my_table.append(table_row=[&#39;.idea&#39;,        4096])</span>
<span class="sd">        &gt;&gt;&gt; row = my_table.append(table_row=[&#39;directory.py&#39;, 1699])</span>
<span class="sd">        &gt;&gt;&gt; row = my_table.append(table_row=[&#39;__init__.py&#39;,    37])</span>
<span class="sd">        &gt;&gt;&gt; row = my_table.append(table_row=[&#39;__pycache__&#39;,  4096])</span>
<span class="sd">        &gt;&gt;&gt; my_table.print()</span>
<span class="sd">        Table: Directory</span>
<span class="sd">        | FileName     | Size |</span>
<span class="sd">        | .idea        | 4096 |</span>
<span class="sd">        | directory.py | 1699 |</span>
<span class="sd">        | __init__.py  |   37 |</span>
<span class="sd">        | __pycache__  | 4096 |</span>

<span class="sd">        This is a possible extension of a format for type iban, breaking the string into chunks of 4:</span>

<span class="sd">        &gt;&gt;&gt; iban = &#39;de1212341234123412&#39;</span>
<span class="sd">        &gt;&gt;&gt; my_table.format_types[&#39;iban&#39;] = lambda x_size, x_val: f&quot;{(&#39; &#39;.join(re.findall(&#39;.{1,4}&#39;, x_val))):&gt;{x_size}}&quot;</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;{my_table.format_types[&#39;iban&#39;](30, iban)}&quot;)</span>
<span class="sd">                de12 1234 1234 1234 12</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">column_names</span><span class="p">:</span>       <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>                       <span class="c1">#: :meta private: List of column names</span>
    <span class="n">title</span><span class="p">:</span>              <span class="nb">str</span>         <span class="o">=</span> <span class="s1">&#39;TTable&#39;</span>          <span class="c1">#: :meta private: Table title name</span>
    <span class="n">column_names_map</span><span class="p">:</span>   <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">TTableCell</span><span class="p">]</span>   <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: :meta private: Map name to columns</span>
    <span class="n">column_names_alias</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>          <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: :meta private: Translated column names</span>
    <span class="n">column_names_filter</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>              <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: :meta private: Index for shuffle columns</span>
    <span class="n">column_descr</span><span class="p">:</span>       <span class="n">List</span><span class="p">[</span><span class="n">TTableColumn</span><span class="p">]</span>      <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: :meta private: Describes each column</span>
    <span class="n">table_index</span><span class="p">:</span>        <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">TTableRow</span><span class="p">]</span>    <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: :meta private: Table unique row index</span>
    <span class="n">attrs</span><span class="p">:</span>              <span class="nb">dict</span>        <span class="o">=</span> <span class="kc">None</span>              <span class="c1">#: :meta private: User attributes</span>
    <span class="n">visible_items</span><span class="p">:</span>      <span class="nb">int</span>         <span class="o">=</span> <span class="mi">20</span>                <span class="c1">#: :meta private: Number of items to show</span>
    <span class="n">offset</span><span class="p">:</span>             <span class="nb">int</span>         <span class="o">=</span> <span class="mi">0</span>                 <span class="c1">#: :meta private: Offset for sequence reading</span>
    <span class="n">selected_row</span><span class="p">:</span>       <span class="n">TTableRow</span>   <span class="o">=</span> <span class="kc">None</span>              <span class="c1">#: :meta private: Selected row</span>
    <span class="n">header_row</span><span class="p">:</span>         <span class="n">TTableRow</span>   <span class="o">=</span> <span class="kc">None</span>              <span class="c1">#: :meta private: Header row of the table</span>
    <span class="n">apply_filter_column</span><span class="p">:</span> <span class="nb">bool</span>       <span class="o">=</span> <span class="kc">False</span>             <span class="c1">#: :meta private: If true columns are reordered and translated</span>
    <span class="n">format_types</span><span class="p">:</span>       <span class="nb">dict</span>        <span class="o">=</span> <span class="kc">None</span>              <span class="c1">#: :meta private: Map output format for value type</span>
    <span class="n">async_condition</span><span class="p">:</span>    <span class="n">Condition</span>   <span class="o">=</span> <span class="n">Condition</span><span class="p">()</span>       <span class="c1">#: :meta private: Used for async access to table</span>
    <span class="n">async_lock</span><span class="p">:</span>         <span class="n">Lock</span>        <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>            <span class="c1">#: :meta private: Used for async access to table values</span>
    <span class="n">database_path</span><span class="p">:</span>      <span class="nb">str</span>         <span class="o">=</span> <span class="s1">&#39;:memory:&#39;</span>        <span class="c1">#: :meta private: The database path</span>
    <span class="n">row_filter_descr</span><span class="p">:</span>   <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">]</span>  <span class="o">=</span> <span class="kc">None</span>              <span class="c1">#: :meta private: The row filter combines column values</span>
    <span class="n">is_synchron</span><span class="p">:</span>        <span class="nb">bool</span>        <span class="o">=</span> <span class="kc">False</span>             <span class="c1">#: :meta private: Used to reduce calls to do_select</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Post init for a data class</span>
<span class="sd">        The value for self.format_types could be customized for own data type formatting</span>
<span class="sd">        The formatter sends size aad value of the column and receives the formatted string &quot;&quot;&quot;</span>

        <span class="c1"># Init the UserList and keep track on the table instances</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table_index</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_descr</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">column_descr</span> <span class="o">=</span> <span class="p">[</span><span class="n">TTableColumn</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">x_inx</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">x_str</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="n">x_str</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x_str</span><span class="p">),</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                                 <span class="k">for</span> <span class="n">x_inx</span><span class="p">,</span> <span class="n">x_str</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_names</span><span class="p">)]</span>

        <span class="n">x_cells</span>               <span class="o">=</span> <span class="p">[</span><span class="n">TTableCell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">x_str</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">x_str</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">x_inx</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x_str</span><span class="p">))</span> <span class="k">for</span> <span class="n">x_inx</span><span class="p">,</span> <span class="n">x_str</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_names</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header_row</span>       <span class="o">=</span> <span class="n">TTableRow</span><span class="p">(</span><span class="n">cells</span><span class="o">=</span><span class="n">x_cells</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;header&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">column_names_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">x_cell</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">x_cell</span> <span class="k">for</span> <span class="n">x_cell</span> <span class="ow">in</span> <span class="n">x_cells</span><span class="p">}</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_types</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">format_types</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;int&#39;</span><span class="p">:</span>      <span class="k">lambda</span> <span class="n">x_size</span><span class="p">,</span> <span class="n">x_val</span><span class="p">:</span> <span class="s1">&#39; {{:&gt;</span><span class="si">{}</span><span class="s1">}} &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_size</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_val</span><span class="p">),</span>
                <span class="s1">&#39;str&#39;</span><span class="p">:</span>      <span class="k">lambda</span> <span class="n">x_size</span><span class="p">,</span> <span class="n">x_val</span><span class="p">:</span> <span class="s1">&#39; {{:&lt;</span><span class="si">{}</span><span class="s1">}} &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_size</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_val</span><span class="p">),</span>
                <span class="s1">&#39;float&#39;</span><span class="p">:</span>    <span class="k">lambda</span> <span class="n">x_size</span><span class="p">,</span> <span class="n">x_val</span><span class="p">:</span> <span class="s1">&#39; {{:&gt;</span><span class="si">{}</span><span class="s1">.2}} &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_size</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_val</span><span class="p">),</span>
                <span class="s1">&#39;datetime&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x_size</span><span class="p">,</span> <span class="n">x_val</span><span class="p">:</span> <span class="s1">&#39; {{:&gt;</span><span class="si">{}</span><span class="s1">}} &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_size</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_val</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%m/</span><span class="si">%d</span><span class="s2">/%Y, %H:%M:%S&quot;</span><span class="p">))}</span>

    <span class="k">def</span> <span class="nf">get_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TTableColumn</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;:meta private:&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="n">filterfalse</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x_cd</span><span class="p">:</span> <span class="n">x_cd</span><span class="o">.</span><span class="n">header</span> <span class="o">!=</span> <span class="n">column_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_descr</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">filter_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;:meta private: Clear the filters and return to original output &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">apply_filter_column</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="TTable.filter_rows">
<a class="viewcode-back" href="../../eezz.html#eezz.table.TTable.filter_rows">[docs]</a>
    <span class="k">def</span> <span class="nf">filter_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_filter_descr</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Set the row filter: Each inner list is joined with &#39;AND&#39;.</span>
<span class="sd">        The outer list joins the inner lists with &#39;OR&#39; &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">row_filter_descr</span> <span class="o">=</span> <span class="n">row_filter_descr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_synchron</span>      <span class="o">=</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="TTable.filter_columns">
<a class="viewcode-back" href="../../eezz.html#eezz.table.TTable.filter_columns">[docs]</a>
    <span class="k">def</span> <span class="nf">filter_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_names</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The column_names is a dictionary with a set of keys as subset of TTable.column_names.</span>
<span class="sd">        The values are translated names to display in output. The order of the keys represents the order in the</span>
<span class="sd">        output.</span>
<span class="sd">        The filter is used to generate customized output. This function could also be used to reduce the number of</span>
<span class="sd">        visible columns</span>

<span class="sd">        :param column_names:    Map new names to a column, e.g. after translation</span>
<span class="sd">        :type  column_names:    Dict[str: str]</span>

<span class="sd">        Example:</span>

<span class="sd">        &gt;&gt;&gt; my_table = TTable(column_names=[&#39;FileName&#39;, &#39;Size&#39;], title=&#39;Directory&#39;)</span>
<span class="sd">        &gt;&gt;&gt; my_table.filter_columns(column_names={&#39;Size&#39;:&#39;Größe&#39;, &#39;FileName&#39;: &#39;Datei&#39;})</span>
<span class="sd">        &gt;&gt;&gt; row = my_table.append([&#39;.idea&#39;,        4096])</span>
<span class="sd">        &gt;&gt;&gt; row = my_table.append([&#39;directory.py&#39;, 1886])</span>
<span class="sd">        &gt;&gt;&gt; row = my_table.append([&#39;__init__.py&#39;,    37])</span>
<span class="sd">        &gt;&gt;&gt; row = my_table.append([&#39;__pycache__&#39;,  4096])</span>
<span class="sd">        &gt;&gt;&gt; my_table.print()</span>
<span class="sd">        Table: Directory</span>
<span class="sd">        | Größe | Datei        |</span>
<span class="sd">        |  4096 | .idea        |</span>
<span class="sd">        |  1886 | directory.py |</span>
<span class="sd">        |    37 | __init__.py  |</span>
<span class="sd">        |  4096 | __pycache__  |</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create a list of column index and a translation of the column header entry</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">column_names_filter</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">column_names_alias</span>  <span class="o">=</span> <span class="n">column_names</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">column_names</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">x_inx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_names_map</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">column_names_filter</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_inx</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">column_descr</span><span class="p">[</span><span class="n">x_inx</span><span class="p">]</span><span class="o">.</span><span class="n">alias</span> <span class="o">=</span> <span class="n">y</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">column_descr</span><span class="p">[</span><span class="n">x_inx</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_descr</span><span class="p">[</span><span class="n">x_inx</span><span class="p">]</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">apply_filter_column</span>       <span class="o">=</span> <span class="kc">True</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">pass</span></div>


<div class="viewcode-block" id="TTable.append">
<a class="viewcode-back" href="../../eezz.html#eezz.table.TTable.append">[docs]</a>
    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_row</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">attrs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">row_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;body&#39;</span><span class="p">,</span> <span class="n">row_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">exists_ok</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TTableRow</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Append a row into the table</span>
<span class="sd">        This procedure also defines the column type and the width</span>

<span class="sd">        :param table_row:   List of values</span>
<span class="sd">        :type  table_row:   List[str]</span>
<span class="sd">        :param attrs:       Customizable attributes</span>
<span class="sd">        :param row_type:    Row type used for output filter</span>
<span class="sd">        :param row_id:      Unique row id, which consists of pattern letters and numbers [a-zA-Z0-9]+</span>
<span class="sd">        :param exists_ok:   Try to append, but do not throw exception, if key exists</span>
<span class="sd">        :return:            The generated row object</span>
<span class="sd">        :rtype:             TTableRow</span>
<span class="sd">        :raise TableInsertException: Exception if row-id already exists</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># define the type with the first line inserted</span>
        <span class="n">x_inx</span>       <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">x_row_descr</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">table_row</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_descr</span><span class="p">))</span>

        <span class="c1"># Check for a valid row_id</span>
        <span class="k">if</span> <span class="n">row_id</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">row_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x_inx</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">x_inx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table_index</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">x_cell</span><span class="p">,</span> <span class="n">x_descr</span> <span class="ow">in</span> <span class="n">x_row_descr</span><span class="p">:</span>
                <span class="n">x_descr</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">x_cell</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>

        <span class="c1"># Check if the row-id is unique</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_index</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">row_id</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_ok</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">TTableException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;InsertException: row-id already exists </span><span class="si">{</span><span class="n">table_row</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">row_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_index</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">row_id</span><span class="p">)</span>

        <span class="n">x_cells</span> <span class="o">=</span> <span class="p">[</span><span class="n">TTableCell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">x_descr</span><span class="o">.</span><span class="n">header</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x_cell</span><span class="p">)),</span> <span class="n">value</span><span class="o">=</span><span class="n">x_cell</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">x_descr</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">x_descr</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_cell</span><span class="p">,</span> <span class="n">x_descr</span> <span class="ow">in</span> <span class="n">x_row_descr</span><span class="p">]</span>
        <span class="n">x_row</span>   <span class="o">=</span> <span class="n">TTableRow</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">x_inx</span><span class="p">,</span> <span class="n">cells</span><span class="o">=</span><span class="n">x_cells</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">row_type</span><span class="p">,</span> <span class="n">row_id</span><span class="o">=</span><span class="n">row_id</span><span class="p">,</span> <span class="n">column_descr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">column_names</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">UserList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_row</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table_index</span><span class="p">[</span><span class="n">row_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_row</span>

        <span class="k">for</span> <span class="n">x_cell</span><span class="p">,</span> <span class="n">x_descr</span> <span class="ow">in</span> <span class="n">x_row_descr</span><span class="p">:</span>
            <span class="n">x_descr</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x_cell</span><span class="p">)),</span> <span class="n">x_descr</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x_row</span></div>


<div class="viewcode-block" id="TTable.get_header_row">
<a class="viewcode-back" href="../../eezz.html#eezz.table.TTable.get_header_row">[docs]</a>
    <span class="k">def</span> <span class="nf">get_header_row</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TTableRow</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Returns the header row.</span>

<span class="sd">        :return: The header of the table</span>
<span class="sd">        :rtype:  TTableRow</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_filter_column</span><span class="p">:</span>
            <span class="c1"># Select the visible columns in the desired order and map the new names</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">header_row</span><span class="o">.</span><span class="n">cells_filter</span> <span class="o">=</span> <span class="p">[</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header_row</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_names_filter</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_row</span><span class="o">.</span><span class="n">cells_filter</span><span class="p">:</span>
                <span class="n">x</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_names_alias</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_row</span></div>


<div class="viewcode-block" id="TTable.get_next_values">
<a class="viewcode-back" href="../../eezz.html#eezz.table.TTable.get_next_values">[docs]</a>
    <span class="k">def</span> <span class="nf">get_next_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search_filter</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">TTableRow</span><span class="p">],</span> <span class="nb">bool</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;  Generator for all elements of a table.</span>
<span class="sd">        Restrict the rows for a search attribute, if specified</span>
<span class="sd">        Remove the search criteria, if now second visit is required</span>

<span class="sd">        :param search_filter: A function that returns True for any row entry to be shown</span>
<span class="sd">        :return: Tuple of values in the order of column names</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x_row</span><span class="p">:</span> <span class="n">TTableRow</span>
        <span class="k">for</span> <span class="n">x_row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">search_filter</span><span class="p">(</span><span class="n">x_row</span><span class="p">):</span>
                <span class="k">yield</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">x_value</span> <span class="k">for</span> <span class="n">x_value</span> <span class="ow">in</span> <span class="n">x_row</span><span class="o">.</span><span class="n">get_values_list</span><span class="p">())</span></div>


<div class="viewcode-block" id="TTable.on_select">
<a class="viewcode-back" href="../../eezz.html#eezz.table.TTable.on_select">[docs]</a>
    <span class="k">def</span> <span class="nf">on_select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TTableRow</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Select a row from cache &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">selected_row</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_index</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_row</span> <span class="o">=</span> <span class="n">selected_row</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_row</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TTableException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Selected row does not exist: </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="TTable.do_select">
<a class="viewcode-back" href="../../eezz.html#eezz.table.TTable.do_select">[docs]</a>
    <span class="k">def</span> <span class="nf">do_select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">filter_descr</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Create and execute a select statement on the given database.</span>
<span class="sd">        For a :memory: database this method achieves a complex search combining multiple columns</span>
<span class="sd">        returning the values and the row index of the internal data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sqlite3</span><span class="o">.</span><span class="n">register_adapter</span><span class="p">(</span><span class="n">datetime</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x_val</span><span class="p">:</span> <span class="n">x_val</span><span class="o">.</span><span class="n">isoformat</span><span class="p">())</span>
        <span class="n">sqlite3</span><span class="o">.</span><span class="n">register_converter</span><span class="p">(</span><span class="s2">&quot;datetime&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x_val</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">x_val</span><span class="o">.</span><span class="n">decode</span><span class="p">()))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_synchron</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">logger</span>      <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>
        <span class="n">x_database</span>  <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">database_path</span><span class="p">)</span>
        <span class="n">x_cursor</span>    <span class="o">=</span> <span class="n">x_database</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="n">x_ty_map</span>    <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;int&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span> <span class="s1">&#39;str&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="s1">&#39;real&#39;</span><span class="p">}</span>
        <span class="n">x_options</span>   <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">get_all</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39; limit </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">visible_items</span><span class="si">}</span><span class="s1"> offset </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">x_sorted</span>    <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">filterfalse</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">sort</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_descr</span><span class="p">))</span>
        <span class="n">x_sort_stm</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_sorted</span><span class="p">:</span>
            <span class="n">x_sort_stm</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39; order by </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">header</span><span class="si">}</span><span class="s1"> ASC&#39;</span>
            <span class="k">break</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">database_path</span> <span class="o">==</span> <span class="s1">&#39;:memory:&#39;</span><span class="p">:</span>
            <span class="n">x_create_stm</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;create table </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">  (</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">header</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">x_ty_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">type</span><span class="p">)</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">x_ty_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;text&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">column_descr</span><span class="p">)</span><span class="si">}</span><span class="s2">, index_key integer)&quot;&quot;&quot;</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;TTable.do_select: </span><span class="si">{</span><span class="n">x_create_stm</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">x_cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">x_create_stm</span><span class="p">)</span>

            <span class="n">x_insert_stm</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;insert into </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2"> values (</span><span class="si">{</span><span class="p">(</span><span class="s1">&#39;?,&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_names</span><span class="p">))</span><span class="si">}</span><span class="s2"> ?)&quot;&quot;&quot;</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;TTable.do_select: </span><span class="si">{</span><span class="n">x_insert_stm</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="n">x_row</span><span class="p">:</span> <span class="n">TTableRow</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x_row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
                <span class="n">x_cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">x_insert_stm</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">x_row</span><span class="o">.</span><span class="n">get_values_list</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">x_database</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">filter_descr</span><span class="p">:</span>
            <span class="n">x_where</span><span class="p">,</span> <span class="n">x_args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_filter</span><span class="p">(</span><span class="n">filter_descr</span><span class="p">)</span>
            <span class="n">x_select_stm</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;select * from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2"> where </span><span class="si">{</span><span class="n">x_where</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">x_sort_stm</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">x_options</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;TTable.do_select: </span><span class="si">{</span><span class="n">x_select_stm</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">x_cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">x_select_stm</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">x_args</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x_cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;select * from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">x_options</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
        <span class="k">yield from</span> <span class="n">x_cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">create_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_descr</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; :meta private: Return a database select where statement</span>

<span class="sd">        :param filter_descr: An OR array containing AND arrays. Each AND array is evaluated and then</span>
<span class="sd">                            the result is combined to an OR expression. See the following array and the resulting string</span>
<span class="sd">                |br| list[list[&#39;id &gt; 100&#39;, &#39;num &lt; 10], list[&#39;id &lt; 10&#39;]] -&gt;</span>
<span class="sd">                |br| tuple(&#39;(id &gt; ? and num &lt; ?) or (id &lt; ?)&#39;, tuple(&#39;100&#39;,10,10))</span>
<span class="sd">        :return: Valid SQL part as string for a &#39;where&#39; clause and the value list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x_where</span>     <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">x_args</span>      <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">x_or_list</span>   <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">x_or</span> <span class="ow">in</span> <span class="n">filter_descr</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x_and</span> <span class="ow">in</span> <span class="n">x_or</span><span class="p">:</span>
                <span class="n">x_column_name</span><span class="p">,</span> <span class="n">x_op</span><span class="p">,</span> <span class="n">x_value</span> <span class="o">=</span> <span class="n">x_and</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">x_where</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x_column_name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">x_op</span><span class="si">}</span><span class="s1"> ?&#39;</span><span class="p">)</span>
                <span class="n">x_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_value</span><span class="p">)</span>
            <span class="n">x_or_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;(</span><span class="si">{</span><span class="s1">&#39; and &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x_where</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;&quot;&quot;</span><span class="p">)</span>
            <span class="n">x_where</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="s1">&#39; or &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x_or_list</span><span class="p">),</span> <span class="n">x_args</span>

<div class="viewcode-block" id="TTable.get_visible_rows">
<a class="viewcode-back" href="../../eezz.html#eezz.table.TTable.get_visible_rows">[docs]</a>
    <span class="k">def</span> <span class="nf">get_visible_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">TTableRow</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Select table rows using column values pairs, return at maximum visible_items.</span>
<span class="sd">        The value could be any valid regular expression.</span>

<span class="sd">        :param get_all:   If True select more than visible_items</span>
<span class="sd">        :return:          List of selected rows</span>
<span class="sd">        :rtype: List[TTableRow]</span>

<span class="sd">        Example:</span>

<span class="sd">        &gt;&gt;&gt; my_table = TTable(column_names=[&#39;FileName&#39;, &#39;Size&#39;], title=&#39;Directory&#39;)</span>
<span class="sd">        &gt;&gt;&gt; row = my_table.append([&#39;__init__.py&#39;,   37])</span>
<span class="sd">        &gt;&gt;&gt; row = my_table.append([&#39;__pycache__&#39;, 4096])</span>
<span class="sd">        &gt;&gt;&gt; row = my_table.append([&#39;test.py&#39;,     1246])</span>
<span class="sd">        &gt;&gt;&gt; my_table.get_column(&#39;FileName&#39;).filter = &#39;^__[a-zA-Z]*__.py&#39;</span>
<span class="sd">        &gt;&gt;&gt; my_table.print()</span>
<span class="sd">        Table: Directory</span>
<span class="sd">        | FileName    | Size |</span>
<span class="sd">        | __init__.py |   37 |</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># in case the filters is a string, we could also handle tree access</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_filter_descr</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_synchron</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x_selected</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_select</span><span class="p">(</span><span class="n">get_all</span><span class="o">=</span><span class="n">get_all</span><span class="p">,</span> <span class="n">filter_descr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_filter_descr</span><span class="p">):</span>
                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">x_selected</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">x_filter_row</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">filterfalse</span><span class="p">(</span><span class="k">lambda</span> <span class="n">xx_col</span><span class="p">:</span> <span class="ow">not</span> <span class="n">xx_col</span><span class="o">.</span><span class="n">filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_descr</span><span class="p">):</span>
            <span class="n">x_filter_row</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">x</span><span class="o">.</span><span class="n">header</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">filter</span><span class="p">)})</span>

        <span class="c1"># columns: List[str], values: List[str]</span>
        <span class="c1"># Apply the filter for column layout</span>
        <span class="n">x_count</span><span class="p">:</span> <span class="nb">int</span>  <span class="o">=</span> <span class="mi">0</span>
        <span class="n">x_start</span><span class="p">:</span> <span class="nb">int</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>

        <span class="k">for</span> <span class="n">x_row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">x_start</span><span class="p">:]:</span>
            <span class="n">x_match</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">x_count</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible_items</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">get_all</span><span class="p">:</span>
                <span class="k">break</span>

            <span class="k">for</span> <span class="n">x_key</span><span class="p">,</span> <span class="n">x_val</span> <span class="ow">in</span> <span class="n">x_filter_row</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">x_val</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x_row</span><span class="p">[</span><span class="n">x_key</span><span class="p">])):</span>
                    <span class="n">x_match</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">break</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">x_match</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">x_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">yield</span> <span class="n">x_row</span></div>


<div class="viewcode-block" id="TTable.navigate">
<a class="viewcode-back" href="../../eezz.html#eezz.table.TTable.navigate">[docs]</a>
    <span class="k">def</span> <span class="nf">navigate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">where_togo</span><span class="p">:</span> <span class="n">TNavigation</span> <span class="o">=</span> <span class="n">TNavigation</span><span class="o">.</span><span class="n">NEXT</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Navigate in block mode</span>

<span class="sd">        :param where_togo:  Navigation direction</span>
<span class="sd">        :type  where_togo:  TNavigation</span>
<span class="sd">        :param position:    Position for absolute navigation, ignored in any other case</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">match</span> <span class="n">where_togo</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">TNavigation</span><span class="o">.</span><span class="n">NEXT</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible_items</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible_items</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="k">case</span> <span class="n">TNavigation</span><span class="o">.</span><span class="n">PREV</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible_items</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">TNavigation</span><span class="o">.</span><span class="n">ABS</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">position</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible_items</span><span class="p">))</span>
            <span class="k">case</span> <span class="n">TNavigation</span><span class="o">.</span><span class="n">TOP</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">case</span> <span class="n">TNavigation</span><span class="o">.</span><span class="n">LAST</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible_items</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_synchron</span> <span class="o">=</span> <span class="kc">False</span></div>


    <span class="k">def</span> <span class="nf">do_sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="n">reverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TTable</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; :meta private: Toggle sort on a given column index &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x_row</span><span class="p">:</span> <span class="n">x_row</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

<div class="viewcode-block" id="TTable.print">
<a class="viewcode-back" href="../../eezz.html#eezz.table.TTable.print">[docs]</a>
    <span class="k">def</span> <span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Print ASCII formatted table</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x_offset</span>        <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">level</span>
        <span class="n">x_column_descr</span>  <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_descr</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_names_filter</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_filter_column</span> \
                      <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_descr</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x_offset</span><span class="si">}</span><span class="s1">Table: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">x_formatted_row</span> <span class="o">=</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39; {{:&lt;</span><span class="si">{}</span><span class="s1">}} &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_col</span><span class="o">.</span><span class="n">width</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_col</span><span class="o">.</span><span class="n">alias</span><span class="p">)</span>  <span class="k">for</span> <span class="n">x_col</span> <span class="ow">in</span> <span class="n">x_column_descr</span><span class="p">])</span>  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_filter_column</span> \
                    <span class="k">else</span> <span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39; {{:&lt;</span><span class="si">{}</span><span class="s1">}} &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_col</span><span class="o">.</span><span class="n">width</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_col</span><span class="o">.</span><span class="n">header</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_col</span> <span class="ow">in</span> <span class="n">x_column_descr</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x_offset</span><span class="si">}</span><span class="s1">|</span><span class="si">{</span><span class="n">x_formatted_row</span><span class="si">}</span><span class="s1">|&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">x_row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible_rows</span><span class="p">():</span>
            <span class="n">x_cells</span>         <span class="o">=</span> <span class="p">[</span><span class="n">x_row</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_names_filter</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_filter_column</span> <span class="k">else</span> <span class="n">x_row</span><span class="o">.</span><span class="n">cells</span>
            <span class="n">x_row_descr</span>     <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_cells</span><span class="p">,</span> <span class="n">x_column_descr</span><span class="p">)</span>
            <span class="n">x_format_descr</span>  <span class="o">=</span> <span class="p">[(</span><span class="n">x_descr</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">x_descr</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>     <span class="n">x_cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="k">if</span> <span class="n">x_descr</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_types</span>
                          <span class="k">else</span> <span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">,</span>        <span class="n">x_descr</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">x_cell</span><span class="o">.</span><span class="n">value</span><span class="p">))</span> <span class="k">for</span> <span class="n">x_cell</span><span class="p">,</span> <span class="n">x_descr</span> <span class="ow">in</span> <span class="n">x_row_descr</span><span class="p">]</span>

            <span class="n">x_formatted_row</span> <span class="o">=</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">format_types</span><span class="p">[</span><span class="n">x_type</span><span class="p">](</span><span class="n">x_width</span><span class="p">,</span> <span class="n">x_value</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_type</span><span class="p">,</span> <span class="n">x_width</span><span class="p">,</span> <span class="n">x_value</span> <span class="ow">in</span> <span class="n">x_format_descr</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">x_row</span><span class="o">.</span><span class="n">child</span><span class="p">:</span>
                <span class="n">x_row</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x_offset</span><span class="si">}</span><span class="s1">|</span><span class="si">{</span><span class="n">x_formatted_row</span><span class="si">}</span><span class="s1">|&#39;</span><span class="p">)</span></div>
</div>



<span class="k">def</span> <span class="nf">test_table</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;:meta private:&quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Create a table and read the directory with attribute: [File, Size, Access] and print&quot;</span><span class="p">)</span>
    <span class="n">x_path</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span>
    <span class="n">x_table</span> <span class="o">=</span> <span class="n">TTable</span><span class="p">(</span><span class="n">title</span><span class="o">=</span> <span class="s1">&#39;list_files&#39;</span><span class="p">,</span> <span class="n">column_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;File&#39;</span><span class="p">,</span> <span class="s1">&#39;Size&#39;</span><span class="p">,</span> <span class="s1">&#39;Access&#39;</span><span class="p">],</span> <span class="n">visible_items</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x_item</span> <span class="ow">in</span> <span class="n">x_path</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
        <span class="n">x_stat</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">x_item</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">x_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">x_stat</span><span class="o">.</span><span class="n">st_atime</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
        <span class="n">x_table</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x_item</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">x_stat</span><span class="o">.</span><span class="n">st_size</span><span class="p">,</span> <span class="n">x_time</span><span class="p">],</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">x_item</span><span class="p">},</span> <span class="n">row_id</span><span class="o">=</span><span class="n">x_item</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="c1"># Check if row_id works: These entries should be rejected</span>
    <span class="k">for</span> <span class="n">x_item</span> <span class="ow">in</span> <span class="n">x_path</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">x_stat</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">x_item</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">x_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">x_stat</span><span class="o">.</span><span class="n">st_atime</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
            <span class="n">x_table</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x_item</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">x_stat</span><span class="o">.</span><span class="n">st_size</span><span class="p">,</span> <span class="n">x_time</span><span class="p">],</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">x_item</span><span class="p">},</span> <span class="n">row_id</span><span class="o">=</span><span class="n">x_item</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">TTableException</span> <span class="k">as</span> <span class="n">x_except</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Check row-id: Add entries with same row-id should be rejected&#39;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;TableInsertException </span><span class="si">{</span><span class="n">x_item</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">x_except</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">break</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;table header = </span><span class="si">{</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">x_table</span><span class="o">.</span><span class="n">get_header_row</span><span class="p">()</span><span class="o">.</span><span class="n">cells</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">x_table</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s2">&quot;--- Output restricted on File and Size, change the position and translate the column names&quot;</span><span class="p">)</span>
    <span class="n">x_table</span><span class="o">.</span><span class="n">filter_columns</span><span class="p">({</span><span class="s1">&#39;Size&#39;</span><span class="p">:</span> <span class="s1">&#39;Größe&#39;</span><span class="p">,</span> <span class="s1">&#39;File&#39;</span><span class="p">:</span> <span class="s1">&#39;Datei&#39;</span><span class="p">})</span>
    <span class="n">x_table</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;--- Sort for column Size&#39;</span><span class="p">)</span>
    <span class="n">x_table</span><span class="o">.</span><span class="n">apply_filter_column</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">x_table</span><span class="o">.</span><span class="n">do_sort</span><span class="p">(</span><span class="s1">&#39;Size&#39;</span><span class="p">)</span>
    <span class="n">x_table</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;--- Restrict number of visible items&#39;</span><span class="p">)</span>
    <span class="n">x_table</span><span class="o">.</span><span class="n">visible_items</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">x_table</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;--- Navigate to next&#39;</span><span class="p">)</span>
    <span class="n">x_table</span><span class="o">.</span><span class="n">navigate</span><span class="p">(</span><span class="n">where_togo</span><span class="o">=</span><span class="n">TNavigation</span><span class="o">.</span><span class="n">NEXT</span><span class="p">)</span>
    <span class="n">x_table</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>

    <span class="c1"># x_result = [x for x in x_table.do_select(get_all=True, filter_descr=[[&#39;Size &gt; 20000&#39;],[&#39;File like %py&#39;]])]</span>
    <span class="n">x_result</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_table</span><span class="o">.</span><span class="n">do_select</span><span class="p">(</span><span class="n">get_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">filter_descr</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;Size &gt; 10000&quot;</span><span class="p">],[</span><span class="s2">&quot;File like %.py&quot;</span><span class="p">]])]</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;--- result = </span><span class="si">{</span><span class="n">x_result</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">x_table</span><span class="o">.</span><span class="n">visible_items</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">x_table</span><span class="o">.</span><span class="n">filter_rows</span><span class="p">([[</span><span class="s2">&quot;Size &gt; 10000&quot;</span> <span class="p">],[</span><span class="s2">&quot;File like %.py&quot;</span><span class="p">]])</span>
    <span class="n">x_table</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;:meta private:&quot;&quot;&quot;</span>
    <span class="n">TService</span><span class="o">.</span><span class="n">set_environment</span><span class="p">(</span><span class="n">root_path</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;C:\Users\alzer\Projects\github\eezz_full\webroot&#39;</span><span class="p">)</span>

    <span class="n">x_log_path</span> <span class="o">=</span> <span class="n">TService</span><span class="p">()</span><span class="o">.</span><span class="n">logging_path</span> <span class="o">/</span> <span class="s1">&#39;table.log&#39;</span>
    <span class="n">test_table</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Albert Zedlitz.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>